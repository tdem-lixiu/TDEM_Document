<h2 align=center> 怎么进行伪随机波的正演? </h2>

[返回上一级](https://github.com/0chk0/Gitcode)

- 发射波形选择第5种模式，即实际发射波形（用各个时间道电流描述），可以自己手动输入伪随机波的变换，但是
  过于繁琐，故本笔者改善了齐老师的`Pseudo`程序，利用`Pseudo`程序会生成`data.txt`，这是用于记录伪二进制码，还有
  `1D.txt`，这是用于`ATEM modeling 1D-qiu`的伪随机正演的参数输入(即一维正演)，而另外一个文件`3D.txt`是用3维程
  序的伪随机正演(也就是本程序)。

- 此外要注意的事项是：

- 1.首先伪随机的生成，最好生成的伪随机的最后一段的不变号的码元长度要长点(实际上和前面的也有
  一定关系，但是主要是后面的影响比较大)，否则正演得到的曲线是正负变换的，这种是不利于视电阻率定义的(这里
  暂时讨论的是Bz分量)。所以在视电阻率定义之前先看截断后的响应曲线是否是单调的，非正负变换。

- 2.此外，在3D的文件输入中，要控制好计算时间的时间步长，在变换的地方，应该用小步长来描述，而在不变的位
  置上可以用大步长来描述，当然，如果为了省事，也可以直接给出小步长来描述整个波形。

- 3.如果使用了==5实际发射波形，那么输入文件上面的电流大小是无用的，电流大小是实际发射波形第二列的大小。
  这里笔者，只能给出一个成功的例子作为参考：

```txt
    5       #发射波形:==0阶跃响应，==1理论半正弦波形，==2理论梯形波形，==3理论三角波形，==4多波发射波形，==5实际发射波形（用各个时间道电流描述）
    offtime
    36
    1.00000E-07     0
    2.00000E-07     1
    1.00000E-05     1
    1.01000E-05    -1
    3.00000E-05    -1
    3.01000E-05     1
    5.00000E-05     1
    5.01000E-05    -1
    6.00000E-05    -1
    6.01000E-05     1
    7.00000E-05     1
    7.01000E-05    -1
    9.00000E-05    -1
    9.01000E-05     1
    1.00000E-04     1
    1.00100E-04    -1
    1.40000E-04    -1
    1.40100E-04     1
    1.50000E-04     1
    1.50100E-04    -1
    1.60000E-04    -1
    1.60100E-04     1
    1.70000E-04     1
    1.70100E-04    -1
    1.80000E-04    -1
    1.80100E-04     1
    2.10000E-04     1
    2.10100E-04    -1
    2.20000E-04    -1
    2.20100E-04     1
    2.40000E-04     1
    2.40100E-04    -1
    2.70000E-04    -1
    2.70100E-04     1
    3.10000E-04     1
    3.10100E-04     0      #阶跃波形:断电模式（==1线性断电；==2利用开关函数模拟光滑断电）和断电延迟；半正弦波形:波形极性(有几个半正弦波形)，半正弦波宽度，两个反向半正弦波间隔；梯形波:波形极性(有几个梯形波)，上升沿宽度，水平宽度，下降沿宽度，两个反向梯形波间隔；三角波:波形极性(有几个三角波)，上升沿宽度，下降沿宽度，两个反向三角波间隔；
#模型参数
5         #区的个数
1   100.0       100.0       100.0        0   0   0   1   1    #区域编号 电阻率  电阻率欧拉转角 相对磁化系数  相对介电常数
2   100000000.0 100000000.0 100000000.0  0   0   0   1   1
3   100.0       100.0       100.0        0   0   0   1   1
4   100000000.0 100000000.0 100000000.0  0   0   0   1   1
5   100.0        100.0        100.0        0   0   0   1   1  
#测点信息
12         #整个计算时间分成的段数               #100 4.e-5
3101 1.e-7       #每个时间子域的时间道数和时间步长
200 1.e-7
200 2.e-7
200 4.e-7
200 8.e-7
200 1.6e-6
200 3.2e-6
200 6.4e-6
200 1.28e-5
200 2.e-5
200 3.e-5
200 4.5e-5
```